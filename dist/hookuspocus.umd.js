!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.hookuspocus={})}(this,function(n){var e,t,r=[],u=new(WeakMap||Map),o=window.___hookusPocusRunMap||new(WeakMap||Map);window.___hookusPocusRunMap=o;var f=function(n){return function o(){var f=r[t][++e]||(r[t][e]=[{context:r[t][0],hook:n}]);return(u.get(o)||n).apply({},f.concat(Array.from(arguments)))}},i=function(n,e){var u=r[t].map(function(n){if(n[0]&&n[0][e]){var t=n[0][e]();return n[0][e]=0,t}}).filter(function(n){return n instanceof Promise});if(u.length>0){var f=Promise.all(u);o.set(n,o.has(n)?o.get(n).then(f):f)}},c=function(n,e){if(o.has(n)){var t=o.get(n).then(e);return o.set(n,t),t}return e()},a=function(){var n,f=Array.from(arguments);return f[0].pop&&(n=f.shift()),function(n,f,a,s){if(!0!==f)return c(n,function(){return e=0,t=r.push(u.get(n)||[n])-1,u.set(n,r[t]),i(n,"before"),c(n,function(){var e=a.apply(a,s);return i(n,"after"),c(n,function(){return r.pop(),o.delete(n),e})})});o.set(n,i(n,"cleanUp")),u.delete(n)}("boolean"==typeof f[1]?f[0]:f[1]||f[0],!0===f[1]||f[2],f[0],n)},s=f(function(n,e,t,r){return n.s=void 0!==n.s?n.s:r?r(t):t,[n.s,function(t){return n.s=e(n.s,t),n.s}]}),p=function(n,e){u.set(n,e)},v=f(function(n,e,t){n.v&&(!t||t.length===n.v.length&&t.every(function(e){return~n.v.indexOf(e)}))||(n.v=t,n.cleanUp&&n.cleanUp(),n.after=function(){var t=e();return t instanceof Promise?t=t.then(function(e){return n.cleanUp=e}):n.cleanUp=t,t})});n.on=p,n.onStateChanged=function(n){return p(s,function(e,t,r,u){var o=e.hook(e,t,r,u),f=o[0],i=o[1];return[f,function(t){var r=i(t);return f!==r&&n(e.context),r}]})},n.hookus=f,n.pocus=a,n.useLayoutEffect=v,n.useEffect=function(n,e){v(function(){return new Promise(function(e){return requestAnimationFrame(function(t){return e(n())})})},e)},n.useReducer=s,n.useState=function(n){var e=s(function(n,e){return e.value},n),t=e[1];return[e[0],function(n){return t({value:n})}]},n.fidibus=function(n,e){var t=function(){var t=Array.from(arguments);return t.length>0?a(t,n,e):a(n,e)};return t.cleanUp=function(){a(n,e,!0)},t}});
//# sourceMappingURL=hookuspocus.umd.js.map
