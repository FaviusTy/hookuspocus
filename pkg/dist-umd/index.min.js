!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).hookuspocus={})}(this,function(t){"use strict";function e(t,e){if(t!==e)throw new TypeError("Cannot instantiate an arrow function")}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==u.return||u.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o,i=new(WeakMap||Map),r=function(t,n){e(this,void 0);var i=n.hookStates[n.hookStateIndex];return{onCleanUp:function(t){i.cleanUp=t},beforeNextRun:function(t){i.beforeNextRun=t},afterCurrentRun:function(t){i.afterCurrentRun=t},getContext:function(){return o},getValue:function(t){return void 0===i.value&&(i.value=t),i.value},setValue:function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=i.value;i.value=e,!o&&n.onValueChange&&n.onValueChange(t,e,r)}}}.bind(void 0),a=function(t,n){var a=this;return e(this,void 0),function(){if(e(this,a),void 0===o)throw new Error("Hook was called outside of run()!");var u=i.get(o);u.hookStateIndex++,void 0===u.hookStates[u.hookStateIndex]&&(u.hookStates[u.hookStateIndex]={value:void 0},u.hookStates[u.hookStateIndex].hookApi=r(t,u));for(var s=arguments.length,d=new Array(s),h=0;h<s;h++)d[h]=arguments[h];return n.apply(void 0,[u.hookStates[u.hookStateIndex].hookApi].concat(d))}.bind(this)}.bind(void 0);function u(t,e){var n=!0,o=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var u=r.value;u[t]&&(u[t](),u[t]=void 0)}}catch(t){o=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}}var s=function(t,n){if(e(this,void 0),!(t instanceof Object))throw new Error("Context must be an object!");i.set(t,{hookStates:[],hookStateIndex:-1,onValueChange:n})}.bind(void 0),d=function(t){e(this,void 0),u("cleanUp",i.get(t).hookStates)}.bind(void 0),h=function(t){e(this,void 0);var n=i.get(t);u("cleanUp",n.hookStates),n.hookStates.length=0,n.delete(t)}.bind(void 0),f=function(t,n){var r=this;if(e(this,void 0),void 0!==o)throw new Error("Tried to start a run before the end of the previous run!");if(!i.has(t))throw new Error("Tried to start a run without a registered context!");o=t;var a=i.get(o);a.hookStateIndex=-1,u("beforeNextRun",a.hookStates);for(var s=arguments.length,d=new Array(s>2?s-2:0),h=2;h<s;h++)d[h-2]=arguments[h];var f=n.apply(void 0,d),v=function(t){return e(this,r),u("afterCurrentRun",a.hookStates),o=void 0,t}.bind(this);return f instanceof Promise?f.then(v):v(f)}.bind(void 0),v=function(t,n){var o=this,i=n.context,r=n.onValueChange;e(this,void 0),void 0===i&&(i=t),s(i,r);var a=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return f.apply(void 0,[i,t].concat(n))};return a.dispose=function(){e(this,o),h(i),i=void 0,t=void 0}.bind(this),a.cleanUp=function(){return e(this,o),d(i)}.bind(this),a}.bind(void 0),c=a("useReducer",function(t,n,o){var i=this,r=t.getValue,a=t.setValue;e(this,void 0);var u=r(o);return[u,function(t){e(this,i),a(n(u,t))}.bind(this)]}.bind(void 0)),l=function(t){var o=this;e(this,void 0);var i=n(c(function(t,n){return e(this,o),n.value}.bind(this),t),2),r=i[0],a=i[1];return[r,function(t){return e(this,o),a({type:"set_state",value:t})}.bind(this)]}.bind(void 0),p=a("useEffect",function(t,n,o){var i=this,r=t.getValue,a=t.setValue,u=t.onCleanUp,s=t.afterCurrentRun;e(this,void 0);var d=r({}),h=d.values,f=d.cleanUp,v=!1;if(h!==o&&h&&h.length>0){v=!0;for(var c=h.length;c--;)if(o[c]!==h[c]){v=!1;break}h=o}v||(f&&f(),s(function(){var t=this;e(this,i),f=n(),a({values:o,cleanUp:f}),u(f?function(){e(this,t),f()}.bind(this):void 0)}.bind(this)))}.bind(void 0));t.createHook=a,t.hookus=s,t.cleanUp=d,t.dispose=h,t.pocus=f,t.hookuspocus=v,t.useReducer=c,t.useState=l,t.useEffect=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map